<script src='https://api.mapbox.com/mapbox-gl-js/v2.22.0/mapbox-gl.js'></script>

<link href='https://api.mapbox.com/mapbox-gl-js/v2.22.0/mapbox-gl.css' rel='stylesheet' />

<script>
mapboxgl.accessToken = 'YOUR_MAPBOX_ACCESS_TOKEN';

const map3D = new mapboxgl.Map({
    container: 'map', // نفس div الخريطة الحالي
    style: 'mapbox://styles/mapbox/satellite-streets-v12', 
    center: [35.2045, 31.9045],
    zoom: 17.5,
    pitch: 60,       // الميل لتفعيل 3D
    bearing: -17.6,  // دوران الخريطة
    antialias: true
});

// تفعيل التحكم في التجوال الثلاثي
map3D.addControl(new mapboxgl.NavigationControl());

// إضافة بيانات الحاويات كـ GeoJSON (نفس بياناتك)
map3D.on('load', () => {
    map3D.addSource('waste', {
        type: 'geojson',
        data: 'wasteContainer.json'
    });

    map3D.addLayer({
        id: 'waste-points',
        type: 'circle',
        source: 'waste',
        paint: {
            'circle-radius': 6,
            'circle-color': 'orange'
        }
    });

    // إضافة Popup عند الضغط
    map3D.on('click', 'waste-points', function(e) {
        const props = e.features[0].properties;
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(`<b>Region:</b> ${props.region}<br><b>Container Type:</b> ${props.type}`)
            .addTo(map3D);
    });

    map3D.on('mouseenter', 'waste-points', () => map3D.getCanvas().style.cursor = 'pointer');
    map3D.on('mouseleave', 'waste-points', () => map3D.getCanvas().style.cursor = '');
});
</script>
